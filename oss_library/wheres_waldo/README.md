# üîç Where's Waldo? (Detection Library)

A lightweight, pure Python library for detecting watermarks generated by the `waldo` models.

## üì¶ Installation

Since this is a local library, you can simply include the `wheres_waldo` directory in your project or install it in editable mode if you have a `setup.py` (coming soon).

## üõ†Ô∏è Usage

### 1. Detecting Gemma Watermarks (Text)

The `GemmaDetector` looks for:
1.  **Invisible Watermarks**: Zero-width spaces (`\u200b`) hidden in the text (Deterministic).
2.  **Statistical Signals**: A weighted mean score based on n-gram hashing (Probabilistic).

```python
from wheres_waldo import GemmaDetector
from transformers import AutoTokenizer

# You need the tokenizer to decode/process text
tokenizer = AutoTokenizer.from_pretrained("google/gemma-2-2b-it")

detector = GemmaDetector(tokenizer)

text = "This is a generated text with a hidden secret..."
result = detector.detect(text)

print(result)
# Output:
# {
#   "score": 0.85,
#   "verdict": "Watermarked",
#   "method": "Statistical"
# }
```

### 2. Detecting Stable Diffusion Watermarks (Images)

The `StableDiffusionDetector` analyzes the frequency domain (FFT) of an image to find specific ring patterns injected during generation.

```python
from wheres_waldo import StableDiffusionDetector
from PIL import Image

# Load an image
image = Image.open("suspect_image.png")

detector = StableDiffusionDetector(target_radius=40)
result = detector.detect(image)

print(result)
# Output:
# {
#   "z_score": 4.2,
#   "is_generated": True,
#   "confidence": "High"
# }
```

## üß™ How it Works

- **Gemma**: Uses a "Green-Red" list approach combined with a deterministic zero-width character injection.
- **Stable Diffusion**: Injects a high-frequency ring pattern into the image's Fourier transform, which is invisible to the eye but obvious in the frequency domain.
